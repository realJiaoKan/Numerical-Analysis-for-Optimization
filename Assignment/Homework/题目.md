# 作业

1. 考虑函数
   $$
   f(x, y) = x^2 + 2y^2 + xy + x - y + 30。
   $$
   证明 $f$ 满足具有固定步长的梯度下降法的收敛定理。给出保证最快收敛速度的步长值。通过手动计算 $(x_0, y_0) = (3, 3)$ 时该算法的前三次迭代。

2. 给定函数
   $$
   f(x, y) = 4x^2 - 4xy + 2y^2。
   $$
   编写最优步长的梯度下降算法，并手动进行三次迭代。给出 $f(x_0), f(x_1), f(x_2), f(x_3)$ 的值，确保每次迭代的值都在减少。

3. 设 $A$ 为维度为 $d \times d$ 的对称正定矩阵。令
   $$
   \lambda_1 \leq \lambda_2 \leq ... \leq \lambda_d
   $$
   为其特征值，并考虑迭代方法
   $$
   X^{(n+1)} = X^{(n)} - a(AX^{(n)} - b),
   $$
   其中给定 $X^{(0)} \in \mathbb{R}^d$。

   a) 将其写成 $X^{(n+1)} = BX^{(n)} + c$ 的形式，其中 $B, c$ 需要被明确。

   b) 假设 $a \lambda_d < 2$。证明 $B$ 的所有特征值都在 $(-1, 1)$ 之间。因此，证明 $X^{(n)}$ 收敛。极限值是多少？

   c) 对于什么值的 $a$，收敛速度最快？

   d) 编写一个 Python 程序，应用上述迭代方法来计算第一个 TP 中定义的 Laplacian 离散化矩阵的逆矩阵。令 $b$ 为全 1 向量，$X^{(0)} = 0$，$d = 10$，并且 $a = 10^{-2}$。验证 $X^{(10000)}$ 的第七个坐标为 13.9957。

4. 下面的结果称为特征值幂法，用作计算矩阵最大特征值的一种方式。

   **定理 1.** 设 $A$ 为 $d \times d$ 的实矩阵，其特征值为 $\lambda_1, ..., \lambda_p$，且 $|\lambda_1| \leq |\lambda_{2}| \leq ... \leq |\lambda_p|$，并构造迭代
   $$
   x^0 \in \mathbb{R}^d, y^{n+1} = Ax^n, x^{n+1} = \frac{y^{n+1}}{\| y^{n+1} \|}。
   $$

    如果 $x^0$ 不在由前 $p - 1$ 个特征值的特征向量生成的空间中，则
   $$
    < Ax^n, x^n >
   $$
    收敛到 $\lambda_p$。

    a) 假设给定矩阵具有 $d$ 个不相等的实特征值。证明上述收敛结果在没有归一化假设 $\frac{y^{n+1}}{\|y^{n+1}\|}$ 的情况下成立，即通过在由特征向量生成的基中写出任意向量，证明
   $$
    \frac{<Ax^n, x^n>}{\|x^n\|}
   $$
    收敛到最大的特征值。

    b) 考虑优化问题
   $$
    \max < Ax, x >，
   $$
    约束条件为 $x \in B = \{ x \in \mathbb{R}^d, \|x\|_2 \leq 1 \}$。写出投影到 $B$ 上的表达式。

    c) 编写此问题的梯度投影算法。我们可以为收敛性得出什么结论？请说明理由。

    d) 使用特征值幂法编写算法，并结合上述结论讨论收敛性。

5. 通过带惩罚项的梯度法解决以下问题。考虑一个长度为 $L = 2$ 的悬挂电缆，固定于点 $(0, 1)$ 和 $(1, 3/2)$。它被离散化为具有 $N$ 个不同点 $(z_1, y_1), ..., (z_N, y_N)$ 的电缆。定义随机向量
    $$
    u = (x_1, ..., x_N, y_1, ..., y_N) \in \mathbb{R}^{2N}。
    $$
    我们想要在固定点和长度的约束下，最小化电缆的势能 $E(u)$。数学上我们在寻找解 $u \in \mathbb{R}^{2N}$，其中
    $$
    \min_{u \in K} E(u)，\quad E(u) = \frac{1}{N + 1} \sum_{i=1}^{N} y_i
    $$
    且
    $$
    K = \{u \in \mathbb{R}^{2N}, \phi_i(u) = 0, i = 1, ..., N + 1\}，
    $$
    其中每段的长度约束为 $\phi_i(u) = l_i(u) - h$，并且
    $$
    l_i(u) = \sqrt{(x_i - x_{i-1})^2 + (y_i - y_{i-1})^2}, \quad i = 1, ..., N + 1
    $$
    且 $h = \frac{L}{N+1}$，$(x_0, y_0) = (0, 1)$，$(x_{N+1}, y_{N+1}) = (1, 3/2)$。对于惩罚项，我们建议使用函数
    $$
    P(u) = \frac{1}{2} \sum_{i=1}^{N+1} \phi_i^2(u)。
    $$
    a) 编写一个名为 `energy(u)` 的函数，计算 $E$ 的值及其在 $u$ 处的梯度。

    b) 编写一个名为 `penalty(u)` 的函数，计算 $P$ 的值及其在 $u$ 处的梯度。首先证明
    $$
    \frac{\partial P}{\partial x_i}(u) = \left(1 - \frac{h}{l_i}\right)(x_i - x_{i-1}) + \left(1 - \frac{h}{l_{i+1}}\right)(x_i - x_{i+1}),
    $$
    和
    $$
    \frac{\partial P}{\partial y_i}(u) = \left(1 - \frac{h}{l_i}\right)(y_i - y_{i-1}) + \left(1 - \frac{h}{l_{i+1}}\right)(y_i - y_{i+1})。
    $$

    c) 应用固定步长的梯度下降法，求解问题
    $$
    \min_{u \in \mathbb{R}^{2N}} E(u) + \frac{1}{\epsilon} P(u)
    $$
    取随机初始值 $u^0$，$N = 20$，$\epsilon = 0.1$，然后 $\epsilon = 0.01$，常数步长 $a = \frac{\epsilon}{3}$，并采用以下停止准则：
    $$
    \left\|\nabla E(u) + \frac{1}{\epsilon} \nabla P(u) \right\|_\infty \leq 0.001。
    $$

    最终结果应为位置 $(x, y)$。
